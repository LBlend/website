---
import Copy from "@assets/icons/copy.svg";
import Cv from "@assets/icons/cv.svg";
import Discord from "@assets/icons/discord.svg";
import Email from "@assets/icons/email.svg";
import Github from "@assets/icons/github.svg";
import Linkedin from "@assets/icons/linkedin.svg";
import Osu from "@assets/icons/osu.svg";
import Steam from "@assets/icons/steam.svg";

import { useTranslations } from "@i18n/index";

const locale = Astro.locals.locale;
const t = useTranslations(locale);

const i18nData = JSON.stringify({
  copiedXmr: t("footer.copiedXmr"),
});
---

<footer class="mt-32 mb-16 flex flex-col flex-wrap items-center justify-end gap-4">
  <div class="flex flex-wrap items-center justify-center gap-4">
    <a href="mailto:leander@furumo.eu" class="icon-link">
      <Email class="size-8 lg:size-10" />
    </a>
    <a href="https://github.com/LBlend" class="icon-link">
      <Github class="size-8 lg:size-10" />
    </a>
    <a href="https://cv.furumo.eu" class="icon-link">
      <Cv class="size-8 lg:size-10" />
    </a>
    <a href="https://www.linkedin.com/in/leander-west-furumo/" class="icon-link">
      <Linkedin class="size-8 lg:size-10" />
    </a>
    <a href="https://discord.com/users/170506717140877312" class="icon-link">
      <Discord class="size-8 lg:size-10" />
    </a>
    <a href="https://steamcommunity.com/id/lblend/" class="icon-link">
      <Steam class="size-8 lg:size-10" />
    </a>
    <a href="https://osu.ppy.sh/users/8913869" class="icon-link">
      <Osu class="size-8 lg:size-10" />
    </a>
  </div>
  <div class="flex items-center justify-stretch gap-6">
    <a href="/pgp.asc" class="text-xs">{t("footer.pgpKey")}</a>
    <span class="h-4 border border-gray-600"></span>
    <div
      class="flex items-center justify-center gap-1 text-xs text-gray-400 opacity-70"
      id="xmr-container"
      data-i18n={i18nData}
    >
      <button id="xmr-button">
        <Copy class="size-4 cursor-pointer" id="xmr-copy" />
      </button>
      <span id="xmr-address">
        {t("footer.enableJs")}
      </span>
    </div>
  </div>

  <script>
    const XMR_ADDRESS =
      "44U8wJkHjjqQqkucxKMght52TPXotUgQBLMDx9HYtWiYExKmW55bAwMX7FEmVr5KHQfSs7heZibzQDovXAFFUDFNJpNYyAi";

    function initXmrCopy() {
      const container = document.getElementById("xmr-container");
      const button = document.getElementById("xmr-button");
      const addressElement = document.getElementById("xmr-address");
      const copyIcon = document.getElementById("xmr-copy");

      if (!container || !button || !addressElement || !copyIcon) return;

      const i18n = JSON.parse(container.dataset.i18n || "{}");
      const copiedText = i18n.copiedXmr || "Copied XMR!";

      addressElement.textContent = `XMR: ${XMR_ADDRESS.slice(0, 4)}...`;

      copyIcon.addEventListener("click", () => {
        navigator.clipboard.writeText(XMR_ADDRESS);
        addressElement.textContent = copiedText;
        setTimeout(() => {
          addressElement.textContent = `XMR: ${XMR_ADDRESS.slice(0, 4)}...`;
        }, 2000);
      });
    }

    initXmrCopy();
    document.addEventListener("astro:after-swap", initXmrCopy);
  </script>
</footer>
