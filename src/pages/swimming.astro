---
import Papa from "papaparse";

import DefaultPage from "@layouts/DefaultPage.astro";

import SwimmingTable from "@sections/SwimmingTable.astro";

import { useTranslations } from "@i18n/index";

import csvFile from "../assets/swimming.csv?raw";

interface SwimmingRecord {
  Distance: number;
  Stroke: string;
  Time: number;
  Date: Date;
  City: string;
  Country: string;
  PoolLength: number;
  IsPartialDistance: boolean;
}

const locale = Astro.locals.locale;
const t = useTranslations(locale);

const parsed = Papa.parse<SwimmingRecord>(csvFile, { header: true, skipEmptyLines: true });
const data = parsed.data.map((row) => [
  row.Distance,
  row.Stroke,
  row.Time,
  row.Date,
  row.City,
  row.Country,
  row.PoolLength,
  row.IsPartialDistance,
]);
---

<DefaultPage title={t("swimming.pageTitle")} description={t("swimming.description")}>
  <main class="flex flex-col items-center justify-center gap-8 px-4">
    <h1 class="text-6xl font-bold">{t("swimming.title")}</h1>
    <div class="fade-in-section">
      <SwimmingTable data={data} />
    </div>
  </main>
</DefaultPage>
